{{!< default}}

{{#post}}
<article class="letter-full {{post_class}}">
    <div class="letter-full-paper">
        <header class="letter-full-header">
            <div class="letter-stamp">
                <svg viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="2" y="2" width="56" height="56" rx="2" stroke="currentColor" stroke-width="1" stroke-dasharray="4 2"/>
                    <circle cx="30" cy="25" r="12" stroke="currentColor" stroke-width="1.5"/>
                    <path d="M30 37 L30 50" stroke="currentColor" stroke-width="1.5"/>
                    <text x="30" y="55" text-anchor="middle" font-size="6" fill="currentColor">{{date format="M.D"}}</text>
                </svg>
            </div>
            
            <time class="letter-full-date" datetime="{{date format="YYYY-MM-DD"}}">
                {{date format="YYYY年M月D日 dddd"}}
            </time>
            
            <h1 class="letter-full-title">{{title}}</h1>
            
            {{#if primary_tag}}
            <div class="letter-full-tags">
                {{#foreach tags}}
                <a href="{{url}}" class="tag">{{name}}</a>
                {{/foreach}}
            </div>
            {{/if}}
        </header>

        {{#if feature_image}}
        <figure class="letter-full-image">
            <img src="{{feature_image}}" alt="{{#if feature_image_alt}}{{feature_image_alt}}{{else}}{{title}}{{/if}}">
            {{#if feature_image_caption}}
            <figcaption>{{feature_image_caption}}</figcaption>
            {{/if}}
        </figure>
        {{/if}}

        <div class="letter-full-content gh-content">
            {{content}}
        </div>

        <footer class="letter-full-footer">
            <div class="letter-signature">
                {{#primary_author}}
                <div class="signature-line">
                    <span class="signature-label">写信人</span>
                    <span class="signature-name">{{name}}</span>
                </div>
                {{#if bio}}
                <p class="signature-bio">{{bio}}</p>
                {{/if}}
                {{/primary_author}}
            </div>
            
            <div class="letter-share">
                <span class="share-label">分享这封信</span>
                <div class="share-buttons">
                    <a href="https://twitter.com/intent/tweet?url={{url absolute="true"}}&text={{encode title}}" target="_blank" rel="noopener" class="share-button share-twitter" title="分享到 Twitter">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                    </a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u={{url absolute="true"}}" target="_blank" rel="noopener" class="share-button share-facebook" title="分享到 Facebook">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                    </a>
                    <button class="share-button share-copy" onclick="navigator.clipboard.writeText('{{url absolute="true"}}'); this.classList.add('copied');" title="复制链接">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2"/>
                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                        </svg>
                    </button>
                </div>
            </div>
        </footer>
    </div>

    {{!-- Syunjyu 的回复区域 --}}
    {{#if @custom.show_reply_section}}
    <section class="syunjyu-reply">
        <div class="reply-header">
            <div class="reply-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z"/>
                </svg>
            </div>
            <h3 class="reply-title">Syunjyu 的回复</h3>
        </div>
        <div class="reply-content">
            {{!-- Ghost 的评论区会显示在这里 --}}
            {{comments}}
        </div>
    </section>
    {{/if}}

    {{!-- 相关文章/其他信件 --}}
    {{#get "posts" filter="id:-{{id}}" limit="3" as |related|}}
    {{#if related}}
    <section class="related-letters">
        <h3 class="related-title">其他信件</h3>
        <div class="related-list">
            {{#foreach related}}
            <a href="{{url}}" class="related-card">
                <time class="related-date">{{date format="M月D日"}}</time>
                <h4 class="related-card-title">{{title}}</h4>
            </a>
            {{/foreach}}
        </div>
    </section>
    {{/if}}
    {{/get}}
</article>
{{/post}}
